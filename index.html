<!DOCTYPE html>
<html lang="ar" dir="rtl" class="dark">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>NUBL - Unified Prototype</title>

    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com" rel="preconnect" />
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
    <link
        href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@400;500;700&family=Inter:wght@400;500;700;800;900&family=Fira+Code:wght@500&display=swap"
        rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- React & Router Dependencies (v6.3.0) -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/history@5/umd/history.development.js"></script>
    <script src="https://unpkg.com/react-router@6.3.0/umd/react-router.development.js"></script>
    <script src="https://unpkg.com/react-router-dom@6.3.0/umd/react-router-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>

    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#9156f5",
                        "primary-hover": "#7e46d9",
                        "primary-red": "#f55656",
                        "background-light": "#f6f5f8",
                        "background-dark": "#171022",
                        "surface-dark": "#231834",
                        "border-dark": "#453168",
                        "success": "#198754",
                        "danger": "#DC3545",
                        "warning": "#f59e0b",
                    },
                    fontFamily: {
                        "display": ["IBM Plex Sans Arabic", "Inter", "sans-serif"],
                        "mono": ["Fira Code", "monospace"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "1rem",
                        "xl": "1.5rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        /* Shared Styles */
        body {
            font-family: 'IBM Plex Sans Arabic', 'Inter', sans-serif;
        }

        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #171022;
        }

        ::-webkit-scrollbar-thumb {
            background: #302249;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #453168;
        }

        /* Lucide fix for RTL */
        [dir="rtl"] .lucide {
            transform: scaleX(-1);
        }

        /* Smooth transitions */
        .page-transition {
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body
    class="bg-background-light dark:bg-background-dark font-display text-gray-900 dark:text-white transition-colors duration-300">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, createContext, useContext, useMemo } = React;
        const { createRoot } = ReactDOM;
        const { MemoryRouter, Routes, Route, Link, useNavigate, useLocation, Outlet } = ReactRouterDOM;

        // --- Translations ---
        const TRANSLATIONS = {
            en: {
                home: "Home",
                requests: "Requests",
                newRequest: "New Request",
                login: "Login",
                signup: "Sign Up",
                logout: "Logout",
                dashboard: "Dashboard",
                pending: "Pending",
                approved: "Approved",
                rejected: "Rejected",
                review: "Review",
                submit: "Submit Request",
                back: "Back",
                total: "Total",
                subtotal: "Subtotal",
                vat: "VAT (15%)",
                grandTotal: "Grand Total",
                quantity: "Qty",
                price: "Price",
                items: "Items",
                provider: "Provider",
                selectProvider: "Select Provider",
                providerHint: "Showing providers in your area.",
                approvedItems: "Approved Items",
                food: "Food Items",
                hygiene: "Hygiene Products",
                remainingLimit: "Remaining Limit",
                sar: "SAR",
                reviewTitle: "Review Your Request",
                confirmInfo: "I confirm the information is accurate.",
                requestSent: "Request sent — Pending review",
                requestSentDesc: "Your submission was successful and is pending admin review.",
                goToHistory: "Go to History",
                backToHome: "Back to Home",
                otpTitle: "Enter Verification Code",
                otpDesc: "We sent a 6-digit code to your device",
                verify: "Verify",
                rejectedTitle: "Your request was not approved",
                rejectedDesc: "Please review details below.",
                editRequest: "Edit Request",
                appeal: "Appeal / Edit",
                appealTitle: "Submit Appeal",
                appealDesc: "Please provide a clear reason.",
                upload: "Click to Upload",
                send: "Send",
                cancel: "Cancel",
                qrReady: "Your QR Code is Ready",
                qrDesc: "Present this code for scanning.",
                qrAlt: "Alternative Code",
                securityNote: "Security Note",
                securityDesc: "This code is valid for one-time use.",
                expired: "QR code expired / redeemed",
                expiredDesc: "No longer valid.",
                requestNewQr: "Request New QR",
                welcome: "Welcome",
                noRequests: "No requests yet",
                recentRequests: "Recent Requests",
                summary: "Requests Summary",
                status_pending: "In Review",
                status_approved: "Approved",
                status_rejected: "Rejected",
                add: "Add",
                remove: "Remove",
                date: "Date",
                status: "Status",
                amount: "Amount",
                provider_abu_ahmed: "Abu Ahmed Grocery",
                provider_city_bakery: "City Bakery",
                provider_al_shifa: "Al-Shifa Pharmacy",
                heroTitle: "New Request",
                heroDesc: "Start a new request for food supplies from approved providers in your area.",
            },
            ar: {
                home: "الرئيسية",
                requests: "الطلبات",
                newRequest: "طلب جديد",
                login: "تسجيل الدخول",
                signup: "إنشاء حساب",
                logout: "تسجيل خروج",
                dashboard: "لوحة التحكم",
                pending: "قيد المراجعة",
                approved: "موافق عليه",
                rejected: "مرفوض",
                review: "مراجعة",
                submit: "إرسال الطلب",
                back: "رجوع",
                total: "الإجمالي",
                subtotal: "المجموع الفرعي",
                vat: "ضريبة القيمة المضافة (15%)",
                grandTotal: "الإجمالي الكلي",
                quantity: "الكمية",
                price: "السعر",
                items: "الأصناف",
                provider: "المزوّد",
                selectProvider: "اختر المزوّد",
                providerHint: "يتم عرض المزودين في منطقتك فقط.",
                approvedItems: "السلع المعتمدة",
                food: "المواد الغذائية",
                hygiene: "منتجات النظافة",
                remainingLimit: "المبلغ المتبقي من الحد",
                sar: "ر.س",
                reviewTitle: "مراجعة الطلب",
                confirmInfo: "أقر بأن المعلومات صحيحة.",
                requestSent: "تم الإرسال — قيد المراجعة",
                requestSentDesc: "تم استلام طلبك بنجاح وهو قيد المراجعة من قبل الإدارة.",
                goToHistory: "الذهاب للسجل",
                backToHome: "العودة للرئيسية",
                otpTitle: "أدخل رمز التحقق",
                otpDesc: "تم إرسال رمز مكون من 6 أرقام إلى جهازك",
                verify: "تحقق",
                rejectedTitle: "لم تتم الموافقة على طلبك",
                rejectedDesc: "يرجى مراجعة التفاصيل أدناه.",
                editRequest: "تعديل الطلب",
                appeal: "استئناف / تعديل",
                appealTitle: "تقديم استئناف",
                appealDesc: "يرجى تقديم سبب واضح.",
                upload: "انقر للتحميل",
                send: "إرسال",
                cancel: "إلغاء",
                qrReady: "رمز QR جاهز",
                qrDesc: "اعرض هذا الرمز للمسح.",
                qrAlt: "الرمز البديل",
                securityNote: "ملاحظة أمان",
                securityDesc: "هذا الرمز صالح للاستخدام مرة واحدة.",
                expired: "الرمز منتهي الصلاحية",
                expiredDesc: "لم يعد صالحاً.",
                requestNewQr: "طلب رمز جديد",
                welcome: "مرحباً",
                noRequests: "لا توجد طلبات بعد",
                recentRequests: "أحدث الطلبات",
                summary: "ملخص الطلبات",
                status_pending: "قيد المراجعة",
                status_approved: "موافق عليه",
                status_rejected: "مرفوض",
                add: "إضافة",
                remove: "إزالة",
                date: "التاريخ",
                status: "الحالة",
                amount: "المبلغ",
                provider_abu_ahmed: "بقالة أبو أحمد",
                provider_city_bakery: "مخبز المدينة",
                provider_al_shifa: "صيدلية الشفاء",
                heroTitle: "طلب جديد",
                heroDesc: "ابدأ طلباً جديداً للمواد الغذائية من المزودين المعتمدين في منطقتك.",
            }
        };

        // --- Data Structures ---
        const CATEGORIES = [
            {
                id: 'food',
                nameEn: 'Food Staples',
                nameAr: 'المواد الغذائية',
                items: [
                    {
                        id: 'basmati_rice',
                        nameEn: "Basmati Rice",
                        nameAr: "أرز بسمتي",
                        descEn: "5kg Bag",
                        descAr: "كيس 5 كغ",
                        price: 15.00,
                        image: "https://images.unsplash.com/photo-1586201375761-83865001e31c?auto=format&fit=crop&w=200&q=80"
                    },
                    {
                        id: 'fresh_eggs',
                        nameEn: "Fresh Eggs",
                        nameAr: "بيض طازج",
                        descEn: "Tray of 30",
                        descAr: "طبق 30 حبة",
                        price: 22.50,
                        image: "https://images.unsplash.com/photo-1506976785307-8732e854ad03?auto=format&fit=crop&w=200&q=80"
                    },
                    {
                        id: 'sugar',
                        nameEn: "Sugar",
                        nameAr: "سكر ناعم",
                        descEn: "2kg Pack",
                        descAr: "عبوة 2 كغ",
                        price: 8.00,
                        image: "https://images.unsplash.com/photo-1581441363689-1f3c3c414635?auto=format&fit=crop&w=200&q=80"
                    },
                    {
                        id: 'cooking_oil',
                        nameEn: "Cooking Oil",
                        nameAr: "زيت طبخ",
                        descEn: "1.5L Bottle",
                        descAr: "عبوة 1.5 لتر",
                        price: 18.00,
                        image: "https://images.unsplash.com/photo-1474979266404-7eaacbcd87c5?auto=format&fit=crop&w=200&q=80"
                    },
                ]
            },
            {
                id: 'hygiene',
                nameEn: 'Hygiene Products',
                nameAr: 'منتجات النظافة',
                items: [
                    {
                        id: 'hand_soap',
                        nameEn: "Hand Soap",
                        nameAr: "صابون يد",
                        descEn: "500ml",
                        descAr: "500 مل",
                        price: 12.00,
                        image: "https://images.unsplash.com/photo-1600417148553-16c96934fae1?auto=format&fit=crop&w=200&q=80"
                    },
                    {
                        id: 'detergent',
                        nameEn: "Laundry Detergent",
                        nameAr: "مسحوق غسيل",
                        descEn: "3kg",
                        descAr: "3 كغ",
                        price: 25.00,
                        image: "https://images.unsplash.com/photo-1610557892470-55d9e80c0bce?auto=format&fit=crop&w=200&q=80"
                    },
                ]
            }
        ];

        // --- Context ---
        const AppContext = createContext();

        const AppProvider = ({ children }) => {
            const [language, setLanguage] = useState('ar');
            const [cart, setCart] = useState([]); // { item, quantity }
            const [requests, setRequests] = useState([
                {
                    id: 'req1',
                    createdAt: new Date().toISOString(),
                    providerId: 'provider_abu_ahmed',
                    providerName: { ar: 'بقالة أبو أحمد', en: 'Abu Ahmed Grocery' },
                    items: [{ itemId: 'hand_soap', nameAr: 'صابون يد', nameEn: 'Hand Soap', quantity: 2, unitPrice: 12 }],
                    subtotal: 24,
                    vat: 3.6,
                    total: 27.6,
                    status: 'approved'
                },
                {
                    id: 'req2',
                    createdAt: new Date().toISOString(),
                    providerId: 'provider_city_bakery',
                    providerName: { ar: 'مخبز المدينة', en: 'City Bakery' },
                    items: [{ itemId: 'detergent', nameAr: 'مسحوق غسيل', nameEn: 'Laundry Detergent', quantity: 1, unitPrice: 25 }],
                    subtotal: 25,
                    vat: 3.75,
                    total: 28.75,
                    status: 'rejected'
                }
            ]); // Array of request objects
            const [requestStatus, setRequestStatus] = useState('draft'); // legacy status for compatibility
            const [user, setUser] = useState({ name: "Salem", balance: 500, spent: 44.85 });

            // Effect for Direction & Language
            useEffect(() => {
                document.documentElement.setAttribute('dir', language === 'ar' ? 'rtl' : 'ltr');
                document.documentElement.setAttribute('lang', language);
            }, [language]);

            // Lucide Icons Refresh
            useEffect(() => {
                if (window.lucide) window.lucide.createIcons();
            });

            const t = (key) => TRANSLATIONS[language][key] || key;

            const addToCart = (item) => {
                setCart(prev => {
                    const existing = prev.find(i => i.item.id === item.id);
                    if (existing) {
                        return prev.map(i => i.item.id === item.id ? { ...i, quantity: i.quantity + 1 } : i);
                    }
                    return [...prev, { item, quantity: 1 }];
                });
            };

            const removeFromCart = (itemId) => {
                setCart(prev => prev.filter(i => i.item.id !== itemId));
            };

            const updateQuantity = (itemId, delta) => {
                setCart(prev => {
                    return prev.map(i => {
                        if (i.item.id === itemId) {
                            return { ...i, quantity: i.quantity + delta };
                        }
                        return i;
                    }).filter(i => i.quantity > 0);
                });
            };

            const cartSubtotal = cart.reduce((sum, i) => sum + (i.item.price * i.quantity), 0);
            const cartVat = cartSubtotal * 0.15;
            const cartTotal = cartSubtotal + cartVat;

            const submitRequest = (providerId, providerName) => {
                const newRequest = {
                    id: Date.now().toString(),
                    createdAt: new Date().toISOString(),
                    providerId,
                    providerName, // { ar: string, en: string }
                    items: cart.map(c => ({
                        itemId: c.item.id,
                        nameAr: c.item.nameAr,
                        nameEn: c.item.nameEn,
                        quantity: c.quantity,
                        unitPrice: c.item.price
                    })),
                    subtotal: cartSubtotal,
                    vat: cartVat,
                    total: cartTotal,
                    status: 'pending'
                };

                setRequests(prev => [...prev, newRequest]);
                setUser(prev => ({ ...prev, spent: prev.spent + cartTotal }));
                setCart([]);
                setRequestStatus('pending');
                return newRequest;
            };

            const value = {
                language,
                setLanguage,
                t,
                cart,
                setCart,
                addToCart,
                removeFromCart,
                updateQuantity,
                cartSubtotal,
                cartVat,
                cartTotal,
                requests,
                setRequests,
                submitRequest,
                requestStatus,
                setRequestStatus,
                user
            };

            return <AppContext.Provider value={value}>{children}</AppContext.Provider>;
        };

        const useApp = () => useContext(AppContext);

        // --- Shared Components ---

        const Header = () => {
            const { language, setLanguage, user, t } = useApp();
            const navigate = useNavigate();

            return (
                <header className="sticky top-0 z-40 w-full border-b border-border-dark bg-surface-dark/95 backdrop-blur supports-[backdrop-filter]:bg-surface-dark/60">
                    <div className="container mx-auto flex h-16 items-center justify-between px-4">
                        <div className="flex items-center gap-2 cursor-pointer" onClick={() => navigate('/')}>
                            <span className="material-symbols-outlined text-primary text-3xl">grid_view</span>
                            <span className="text-xl font-bold text-white tracking-tight">NUBL</span>
                        </div>

                        <div className="flex items-center gap-4">
                            <button
                                onClick={() => setLanguage(language === 'ar' ? 'en' : 'ar')}
                                className="flex items-center justify-center rounded-lg border border-border-dark bg-background-dark px-3 py-1.5 text-sm font-medium text-white hover:bg-border-dark transition-colors"
                            >
                                {language === 'ar' ? 'English' : 'العربية'}
                            </button>

                            <div className="hidden md:flex items-center gap-3 pl-4 border-l border-border-dark">
                                <div className="text-end hidden sm:block">
                                    <p className="text-sm font-medium text-white">{user.name}</p>
                                    <p className="text-xs text-[#a690cb]">{t('dashboard')}</p>
                                </div>
                                <div className="h-9 w-9 rounded-full bg-gradient-to-br from-primary to-purple-700 border border-white/10 shadow-inner"></div>
                            </div>
                        </div>
                    </div>
                </header>
            );
        };

        const AppLayout = () => {
            return (
                <div className="min-h-screen bg-background-light dark:bg-background-dark flex flex-col font-display text-gray-900 dark:text-white">
                    <Header />
                    <main className="flex-1 w-full">
                        <Outlet />
                    </main>
                    <PrototypeNav />
                </div>
            );
        };

        const PrototypeNav = () => {
            const [isOpen, setIsOpen] = useState(false);
            const { setRequests, setRequestStatus, requests } = useApp();

            const updateLatestRequestStatus = (status) => {
                if (requests.length > 0) {
                    setRequests(prev => {
                        const newReqs = [...prev];
                        newReqs[newReqs.length - 1] = { ...newReqs[newReqs.length - 1], status };
                        return newReqs;
                    });
                }
                // Also update global status for compatibility with current view if needed
                setRequestStatus(status);
            };

            return (
                <div className="fixed bottom-4 right-4 z-50">
                    <button
                        onClick={() => setIsOpen(!isOpen)}
                        className="bg-primary text-white p-3 rounded-full shadow-lg hover:bg-primary-hover transition-all hover:scale-105"
                        title="Prototype Menu"
                    >
                        <span className="material-symbols-outlined">{isOpen ? 'close' : 'settings'}</span>
                    </button>
                    {isOpen && (
                        <div className="absolute bottom-14 right-0 bg-surface-dark text-white rounded-xl shadow-2xl p-4 w-64 border border-border-dark max-h-[70vh] overflow-y-auto">
                            <h3 className="font-bold mb-2 text-primary border-b border-border-dark pb-1 text-xs uppercase tracking-wider">Navigation</h3>
                            <ul className="space-y-1 text-xs">
                                <li><Link to="/" className="block p-2 hover:bg-white/5 rounded">Home</Link></li>
                                <li><Link to="/request-builder" className="block p-2 hover:bg-white/5 rounded">Request Builder</Link></li>
                                <li><Link to="/review-submit" className="block p-2 hover:bg-white/5 rounded">Review & Submit</Link></li>
                                <li><Link to="/pending" className="block p-2 hover:bg-white/5 rounded">Pending Review</Link></li>
                                <li><Link to="/approved" className="block p-2 hover:bg-white/5 rounded">Approved</Link></li>
                                <li><Link to="/rejected-status" className="block p-2 hover:bg-white/5 rounded">Rejected</Link></li>
                                <li><Link to="/qr-ready" className="block p-2 hover:bg-white/5 rounded">QR Ready</Link></li>
                                <li><Link to="/login" className="block p-2 hover:bg-white/5 rounded">Login</Link></li>
                            </ul>
                            <h3 className="font-bold mt-4 mb-2 text-warning border-b border-border-dark pb-1 text-xs uppercase tracking-wider">Debug State</h3>
                            <div className="flex flex-col gap-2">
                                <button onClick={() => updateLatestRequestStatus('pending')} className="text-left text-xs p-2 bg-white/5 rounded hover:bg-white/10">Set Last Req: Pending</button>
                                <button onClick={() => updateLatestRequestStatus('approved')} className="text-left text-xs p-2 bg-white/5 rounded hover:bg-white/10">Set Last Req: Approved</button>
                                <button onClick={() => updateLatestRequestStatus('rejected')} className="text-left text-xs p-2 bg-white/5 rounded hover:bg-white/10">Set Last Req: Rejected</button>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        // --- Screen Components ---

        const BeneficiaryHome = () => {
            const { t, user, requests, language } = useApp();
            const navigate = useNavigate();

            const statusColors = {
                pending: "text-warning bg-warning/10",
                approved: "text-success bg-success/10",
                rejected: "text-danger bg-danger/10",
                draft: "text-gray-400 bg-gray-500/10"
            };

            const statusIcons = {
                pending: "hourglass_top",
                approved: "check_circle",
                rejected: "cancel",
                draft: "edit_note"
            };

            const remaining = user.balance - user.spent;
            const remainingRatio = Math.max(0, Math.min(1, remaining / user.balance));

            const pendingCount = requests.filter(r => r.status === 'pending').length;
            const approvedCount = requests.filter(r => r.status === 'approved').length;
            const rejectedCount = requests.filter(r => r.status === 'rejected').length;

            return (
                <div className="container mx-auto p-4 lg:p-8 page-transition">
                    {/* Hero Stats */}
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <div className="bg-surface-dark border border-border-dark p-6 rounded-2xl relative overflow-hidden group">
                            <div className="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity pointer-events-none">
                                <span className="material-symbols-outlined text-8xl">account_balance_wallet</span>
                            </div>
                            <p className="text-gray-400 font-medium mb-1">{t('remainingLimit')}</p>
                            <div className="flex items-baseline gap-2">
                                <span className="text-4xl font-bold text-white">{remaining.toFixed(2)}</span>
                                <span className="text-xl text-primary">{t('sar')}</span>
                            </div>
                            <div className="mt-4 h-1.5 w-full bg-background-dark rounded-full overflow-hidden">
                                <div className="h-full bg-primary rounded-full transition-all duration-500" style={{ width: `${remainingRatio * 100}%` }}></div>
                            </div>
                        </div>

                        <div className="md:col-span-2 bg-gradient-to-r from-primary to-purple-600 p-6 rounded-2xl flex flex-col justify-center items-start text-white shadow-lg shadow-primary/20 relative overflow-hidden">
                            <div className="absolute -right-10 -bottom-10 opacity-20 pointer-events-none">
                                <span className="material-symbols-outlined text-[10rem]">add_shopping_cart</span>
                            </div>
                            <h2 className="text-2xl font-bold mb-2">{t('heroTitle')}</h2>
                            <p className="text-white/80 mb-6 max-w-md">{t('heroDesc')}</p>
                            <button
                                onClick={() => navigate('/request-builder')}
                                className="bg-white text-primary px-6 py-3 rounded-xl font-bold hover:bg-gray-100 transition-colors shadow-md flex items-center gap-2"
                            >
                                <span className="material-symbols-outlined">add</span>
                                {t('newRequest')}
                            </button>
                        </div>
                    </div>

                    {/* Summary Cards */}
                    <h3 className="text-xl font-bold text-white mb-4">{t('summary')}</h3>
                    <div className="grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                        <div className="bg-surface-dark border border-border-dark p-4 rounded-xl flex items-center gap-4 hover:border-primary/50 transition-colors">
                            <div className={`w-12 h-12 rounded-lg flex items-center justify-center ${statusColors.pending}`}>
                                <span className="material-symbols-outlined">{statusIcons.pending}</span>
                            </div>
                            <div>
                                <p className="font-bold text-white capitalize">{t('status_pending')}</p>
                                <p className="text-sm text-gray-400">{pendingCount} {t('requests')}</p>
                            </div>
                        </div>
                        <div className="bg-surface-dark border border-border-dark p-4 rounded-xl flex items-center gap-4 hover:border-primary/50 transition-colors">
                            <div className={`w-12 h-12 rounded-lg flex items-center justify-center ${statusColors.approved}`}>
                                <span className="material-symbols-outlined">{statusIcons.approved}</span>
                            </div>
                            <div>
                                <p className="font-bold text-white capitalize">{t('status_approved')}</p>
                                <p className="text-sm text-gray-400">{approvedCount} {t('requests')}</p>
                            </div>
                        </div>
                        <div className="bg-surface-dark border border-border-dark p-4 rounded-xl flex items-center gap-4 hover:border-primary/50 transition-colors">
                            <div className={`w-12 h-12 rounded-lg flex items-center justify-center ${statusColors.rejected}`}>
                                <span className="material-symbols-outlined">{statusIcons.rejected}</span>
                            </div>
                            <div>
                                <p className="font-bold text-white capitalize">{t('status_rejected')}</p>
                                <p className="text-sm text-gray-400">{rejectedCount} {t('requests')}</p>
                            </div>
                        </div>
                    </div>

                    {/* Recent List */}
                    <h3 className="text-xl font-bold text-white mb-4">{t('recentRequests')}</h3>
                    {requests.length === 0 ? (
                        <div className="bg-surface-dark border border-border-dark rounded-2xl p-8 text-center">
                            <div className="inline-flex items-center justify-center w-20 h-20 rounded-full bg-background-dark mb-4">
                                <span className="material-symbols-outlined text-4xl text-gray-600">inbox</span>
                            </div>
                            <p className="text-gray-400 font-medium">{t('noRequests')}</p>
                        </div>
                    ) : (
                        <div className="space-y-3">
                            {[...requests].reverse().map(req => (
                                <div key={req.id} className="bg-surface-dark border border-border-dark rounded-xl p-4 flex items-center justify-between hover:border-primary/30 transition-colors cursor-pointer" onClick={() => navigate(req.status === 'approved' ? '/approved' : req.status === 'rejected' ? '/rejected-status' : '/pending')}>
                                    <div className="flex items-center gap-4">
                                        <div className={`w-10 h-10 rounded-full flex items-center justify-center ${statusColors[req.status]}`}>
                                            <span className="material-symbols-outlined text-xl">{statusIcons[req.status]}</span>
                                        </div>
                                        <div>
                                            <p className="text-white font-bold">{req.providerName[language]}</p>
                                            <p className="text-xs text-gray-400">{new Date(req.createdAt).toLocaleDateString()}</p>
                                        </div>
                                    </div>
                                    <div className="text-end">
                                        <p className="text-primary font-bold">{req.total.toFixed(2)} {t('sar')}</p>
                                        <span className={`text-xs px-2 py-0.5 rounded-full ${statusColors[req.status]}`}>
                                            {t(`status_${req.status}`)}
                                        </span>
                                    </div>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        };

        const RequestBuilder = () => {
            const { t, language, cart, addToCart, removeFromCart, updateQuantity, cartTotal, cartSubtotal, cartVat, user } = useApp();
            const navigate = useNavigate();
            const [selectedProvider, setSelectedProvider] = useState('provider_abu_ahmed');

            const remaining = user.balance - user.spent - cartTotal;
            const remainingRatio = Math.max(0, Math.min(1, remaining / user.balance));

            return (
                <div className="container mx-auto p-4 lg:p-8 page-transition">
                    <nav className="flex items-center gap-2 text-sm text-gray-400 mb-6">
                        <Link to="/" className="hover:text-primary transition-colors">{t('home')}</Link>
                        <span className="material-symbols-outlined text-sm rtl:rotate-180">chevron_right</span>
                        <span className="text-white font-medium">{t('newRequest')}</span>
                    </nav>

                    <div className="flex flex-col lg:flex-row gap-8">
                        {/* Main Content */}
                        <div className="flex-1 flex flex-col gap-6">
                            {/* Provider Selection */}
                            <div className="bg-surface-dark border border-border-dark rounded-2xl p-6">
                                <label className="block mb-4">
                                    <span className="text-lg font-bold text-white block mb-1">{t('selectProvider')}</span>
                                    <span className="text-sm text-gray-400">{t('providerHint')}</span>
                                </label>
                                <div className="relative">
                                    <span className="material-symbols-outlined absolute top-1/2 -translate-y-1/2 left-4 rtl:right-4 rtl:left-auto text-gray-400 pointer-events-none">storefront</span>
                                    <select
                                        value={selectedProvider}
                                        onChange={(e) => setSelectedProvider(e.target.value)}
                                        className="w-full bg-background-dark border border-border-dark rounded-xl py-3 px-12 text-white focus:border-primary focus:ring-1 focus:ring-primary appearance-none cursor-pointer"
                                    >
                                        <option value="provider_abu_ahmed">{t('provider_abu_ahmed')}</option>
                                        <option value="provider_city_bakery">{t('provider_city_bakery')}</option>
                                        <option value="provider_al_shifa">{t('provider_al_shifa')}</option>
                                    </select>
                                    <span className="material-symbols-outlined absolute top-1/2 -translate-y-1/2 right-4 rtl:left-4 rtl:right-auto text-gray-400 pointer-events-none">expand_more</span>
                                </div>
                            </div>

                            {/* Categories & Items */}
                            <div className="space-y-8">
                                {CATEGORIES.map(cat => (
                                    <div key={cat.id}>
                                        <h2 className="text-xl font-bold text-white mb-4 border-b border-border-dark pb-2">{language === 'ar' ? cat.nameAr : cat.nameEn}</h2>
                                        <div className="space-y-4">
                                            {cat.items.map(item => {
                                                const inCart = cart.find(c => c.item.id === item.id);
                                                return (
                                                    <div key={item.id} className="bg-surface-dark border border-border-dark rounded-xl p-4 flex flex-col sm:flex-row items-center gap-4 hover:border-primary/30 transition-colors group">
                                                        <img src={item.image} alt={item.nameEn} className="w-20 h-20 rounded-lg object-cover bg-background-dark" />
                                                        <div className="flex-1 text-center sm:text-start w-full">
                                                            <div className="flex justify-between items-start">
                                                                <div>
                                                                    <h3 className="font-bold text-white text-lg">{language === 'ar' ? item.nameAr : item.nameEn}</h3>
                                                                    <p className="text-sm text-gray-400">{language === 'ar' ? item.descAr : item.descEn}</p>
                                                                </div>
                                                                <p className="text-primary font-bold text-lg">{item.price.toFixed(2)} <span className="text-xs">{t('sar')}</span></p>
                                                            </div>

                                                            <div className="mt-4 flex items-center justify-between sm:justify-start gap-4">
                                                                {inCart ? (
                                                                    <div className="flex items-center gap-3 bg-background-dark rounded-lg p-1 border border-border-dark">
                                                                        <button onClick={() => updateQuantity(item.id, -1)} className="w-8 h-8 flex items-center justify-center rounded bg-surface-dark text-white hover:bg-border-dark transition-colors">
                                                                            <span className="material-symbols-outlined text-sm">remove</span>
                                                                        </button>
                                                                        <span className="w-8 text-center font-bold text-white">{inCart.quantity}</span>
                                                                        <button onClick={() => updateQuantity(item.id, 1)} className="w-8 h-8 flex items-center justify-center rounded bg-primary text-white hover:bg-primary-hover transition-colors">
                                                                            <span className="material-symbols-outlined text-sm">add</span>
                                                                        </button>
                                                                    </div>
                                                                ) : (
                                                                    <button onClick={() => addToCart(item)} className="bg-white/5 hover:bg-white/10 text-primary font-bold py-2 px-6 rounded-xl border border-primary/20 transition-colors flex items-center gap-2">
                                                                        <span className="material-symbols-outlined text-sm">add_shopping_cart</span>
                                                                        {t('add')}
                                                                    </button>
                                                                )}

                                                                {inCart && (
                                                                    <div className="flex items-center gap-4 flex-1 justify-end">
                                                                        <span className="font-bold text-white">{(item.price * inCart.quantity).toFixed(2)} {t('sar')}</span>
                                                                        <button onClick={() => removeFromCart(item.id)} className="text-gray-500 hover:text-danger transition-colors" title={t('remove')}>
                                                                            <span className="material-symbols-outlined">delete</span>
                                                                        </button>
                                                                    </div>
                                                                )}
                                                            </div>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>

                        {/* Sidebar Summary */}
                        <div className="lg:w-96">
                            <div className="sticky top-24 bg-surface-dark border border-border-dark rounded-2xl p-6 flex flex-col gap-6 shadow-xl">
                                <h3 className="text-xl font-bold text-white">{t('summary')}</h3>

                                {/* Progress Bar */}
                                <div>
                                    <div className="flex justify-between text-sm mb-2">
                                        <span className="text-gray-400">{t('remainingLimit')}</span>
                                        <span className="text-white font-medium">{remaining.toFixed(2)} / {user.balance}</span>
                                    </div>
                                    <div className="h-2 w-full bg-background-dark rounded-full overflow-hidden">
                                        <div
                                            className={`h-full rounded-full transition-all duration-500 ${remainingRatio < 0.2 ? 'bg-danger' : 'bg-warning'}`}
                                            style={{ width: `${remainingRatio * 100}%` }}
                                        ></div>
                                    </div>
                                </div>

                                <div className="space-y-2 text-sm text-gray-300">
                                    <div className="flex justify-between">
                                        <span>{t('subtotal')}</span>
                                        <span>{cartSubtotal.toFixed(2)} {t('sar')}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span>{t('vat')}</span>
                                        <span>{cartVat.toFixed(2)} {t('sar')}</span>
                                    </div>
                                </div>

                                <div className="border-t border-border-dark pt-4">
                                    <div className="flex justify-between items-center text-xl font-bold">
                                        <span className="text-white">{t('grandTotal')}</span>
                                        <span className="text-primary">{cartTotal.toFixed(2)} <span className="text-sm">{t('sar')}</span></span>
                                    </div>
                                </div>

                                <button
                                    onClick={() => navigate('/review-submit', { state: { providerId: selectedProvider } })}
                                    disabled={cart.length === 0}
                                    className="w-full bg-primary disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-bold py-4 rounded-xl shadow-lg shadow-primary/20 hover:bg-primary-hover transition-all flex items-center justify-center gap-2"
                                >
                                    <span className="material-symbols-outlined">send</span>
                                    {t('review')}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const ReviewSubmit = () => {
            const { t, language, cart, cartSubtotal, cartVat, cartTotal, submitRequest } = useApp();
            const navigate = useNavigate();
            const location = useLocation();
            const providerId = (location.state && location.state.providerId) || 'provider_abu_ahmed';

            const handleSubmit = () => {
                const providerName = {
                    ar: t(providerId), // Assuming translation keys match provider IDs for simplicity in this prototype
                    en: t(providerId)
                };
                // In a real app we'd map IDs to names properly, here we rely on t() returning the translated string directly
                // But wait, t() returns the string for the current language. 
                // Let's construct it manually for the prototype data consistency
                const pName = {
                    ar: TRANSLATIONS.ar[providerId],
                    en: TRANSLATIONS.en[providerId]
                };

                submitRequest(providerId, pName);
                navigate('/pending');
            };

            return (
                <div className="container mx-auto p-4 lg:p-8 max-w-4xl page-transition">
                    <button onClick={() => navigate(-1)} className="flex items-center gap-2 text-gray-400 hover:text-white mb-6 transition-colors">
                        <span className="material-symbols-outlined rtl:rotate-180">arrow_back</span>
                        {t('back')}
                    </button>

                    <h1 className="text-3xl font-bold text-white mb-8">{t('reviewTitle')}</h1>

                    <div className="bg-surface-dark border border-border-dark rounded-2xl overflow-hidden mb-8">
                        <div className="overflow-x-auto">
                            <table className="w-full text-left rtl:text-right">
                                <thead className="bg-background-dark text-xs uppercase text-gray-400 font-medium">
                                    <tr>
                                        <th className="px-6 py-4">{t('items')}</th>
                                        <th className="px-6 py-4 text-center">{t('quantity')}</th>
                                        <th className="px-6 py-4 text-end">{t('price')}</th>
                                        <th className="px-6 py-4 text-end">{t('total')}</th>
                                    </tr>
                                </thead>
                                <tbody className="divide-y divide-border-dark">
                                    {cart.map(({ item, quantity }) => (
                                        <tr key={item.id} className="text-white">
                                            <td className="px-6 py-4 font-medium">
                                                {language === 'ar' ? item.nameAr : item.nameEn}
                                                <span className="block text-xs text-gray-500 font-normal">{language === 'ar' ? item.descAr : item.descEn}</span>
                                            </td>
                                            <td className="px-6 py-4 text-center">{quantity}</td>
                                            <td className="px-6 py-4 text-end text-gray-400">{item.price.toFixed(2)}</td>
                                            <td className="px-6 py-4 text-end font-bold">{(item.price * quantity).toFixed(2)}</td>
                                        </tr>
                                    ))}
                                    {cart.length === 0 && (
                                        <tr>
                                            <td colSpan="4" className="px-6 py-8 text-center text-gray-500">No items selected</td>
                                        </tr>
                                    )}
                                </tbody>
                            </table>
                        </div>
                        <div className="bg-background-dark/50 p-6 flex flex-col gap-2 border-t border-border-dark">
                            <div className="flex justify-between items-center text-gray-300">
                                <span>{t('subtotal')}</span>
                                <span>{cartSubtotal.toFixed(2)} {t('sar')}</span>
                            </div>
                            <div className="flex justify-between items-center text-gray-300">
                                <span>{t('vat')}</span>
                                <span>{cartVat.toFixed(2)} {t('sar')}</span>
                            </div>
                            <div className="flex justify-between items-center text-xl font-bold text-white mt-2 pt-2 border-t border-gray-700">
                                <span>{t('grandTotal')}</span>
                                <span>{cartTotal.toFixed(2)} {t('sar')}</span>
                            </div>

                            <label className="flex items-center gap-3 cursor-pointer group mt-4">
                                <input type="checkbox" className="w-5 h-5 rounded border-gray-600 bg-background-dark text-primary focus:ring-primary" />
                                <span className="text-gray-300 group-hover:text-white transition-colors">{t('confirmInfo')}</span>
                            </label>
                        </div>
                    </div>

                    <div className="flex gap-4">
                        <button onClick={() => navigate('/request-builder')} className="flex-1 py-3 rounded-xl border border-border-dark text-white font-bold hover:bg-white/5 transition-colors">
                            {t('editRequest')}
                        </button>
                        <button onClick={handleSubmit} className="flex-1 py-3 rounded-xl bg-primary text-white font-bold shadow-lg shadow-primary/20 hover:bg-primary-hover transition-colors">
                            {t('submit')}
                        </button>
                    </div>
                </div>
            );
        };

        const PendingReview = () => {
            const { t } = useApp();
            const navigate = useNavigate();

            return (
                <div className="flex-1 flex items-center justify-center p-4 page-transition">
                    <div className="bg-surface-dark border border-border-dark rounded-2xl p-8 max-w-lg w-full text-center">
                        <div className="w-20 h-20 bg-warning/10 rounded-full flex items-center justify-center mx-auto mb-6">
                            <span className="material-symbols-outlined text-4xl text-warning animate-pulse">hourglass_top</span>
                        </div>
                        <h1 className="text-2xl font-bold text-white mb-2">{t('requestSent')}</h1>
                        <p className="text-gray-400 mb-8">{t('requestSentDesc')}</p>

                        {/* Stepper */}
                        <div className="flex items-center justify-between relative mb-10 px-4">
                            <div className="absolute top-1/2 left-0 w-full h-0.5 bg-border-dark -z-10"></div>
                            <div className="flex flex-col items-center gap-2 bg-surface-dark px-2">
                                <div className="w-8 h-8 rounded-full bg-success flex items-center justify-center text-white">
                                    <span className="material-symbols-outlined text-sm">check</span>
                                </div>
                                <span className="text-xs text-success font-bold">Sent</span>
                            </div>
                            <div className="flex flex-col items-center gap-2 bg-surface-dark px-2">
                                <div className="w-8 h-8 rounded-full bg-warning flex items-center justify-center text-white animate-pulse">
                                    <span className="material-symbols-outlined text-sm">more_horiz</span>
                                </div>
                                <span className="text-xs text-warning font-bold">Review</span>
                            </div>
                            <div className="flex flex-col items-center gap-2 bg-surface-dark px-2">
                                <div className="w-8 h-8 rounded-full bg-border-dark flex items-center justify-center text-gray-500">
                                    <span className="material-symbols-outlined text-sm">circle</span>
                                </div>
                                <span className="text-xs text-gray-500">Decision</span>
                            </div>
                        </div>

                        <div className="flex gap-3">
                            <button onClick={() => navigate('/')} className="flex-1 py-3 rounded-xl border border-border-dark text-white font-bold hover:bg-white/5 transition-colors">
                                {t('backToHome')}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const OTPVerification = () => {
            const { t } = useApp();
            const navigate = useNavigate();
            const [otp, setOtp] = useState(['', '', '', '', '', '']);

            const handleChange = (element, index) => {
                if (isNaN(element.value)) return;
                const newOtp = [...otp];
                newOtp[index] = element.value;
                setOtp(newOtp);

                // Auto-focus next
                if (element.value && element.nextSibling) {
                    element.nextSibling.focus();
                }
            };

            return (
                <div className="flex-1 flex items-center justify-center p-4 page-transition">
                    <div className="bg-surface-dark border border-border-dark rounded-2xl p-8 max-w-md w-full text-center shadow-2xl">
                        <h1 className="text-2xl font-bold text-white mb-2">{t('otpTitle')}</h1>
                        <p className="text-gray-400 mb-8">{t('otpDesc')}</p>

                        <div className="flex justify-center gap-2 mb-8" dir="ltr">
                            {otp.map((data, index) => (
                                <input
                                    key={index}
                                    type="text"
                                    maxLength="1"
                                    className="w-12 h-14 bg-background-dark border border-border-dark rounded-lg text-center text-xl text-white focus:border-primary focus:ring-1 focus:ring-primary transition-all"
                                    value={data}
                                    onChange={e => handleChange(e.target, index)}
                                    onFocus={e => e.target.select()}
                                />
                            ))}
                        </div>

                        <button onClick={() => navigate('/pending')} className="w-full py-3 rounded-xl bg-primary text-white font-bold hover:bg-primary-hover transition-colors shadow-lg shadow-primary/20">
                            {t('verify')}
                        </button>
                    </div>
                </div>
            );
        };

        const Approved = () => {
            const { t } = useApp();
            const navigate = useNavigate();

            return (
                <div className="flex-1 flex items-center justify-center p-4 page-transition">
                    <div className="bg-surface-dark border border-border-dark rounded-2xl p-8 max-w-lg w-full text-center">
                        <div className="w-20 h-20 bg-success/10 rounded-full flex items-center justify-center mx-auto mb-6">
                            <span className="material-symbols-outlined text-4xl text-success">check_circle</span>
                        </div>
                        <h1 className="text-2xl font-bold text-white mb-2">{t('status_approved')}</h1>
                        <p className="text-gray-400 mb-8">Your request has been approved. You can now access your QR code.</p>

                        <button onClick={() => navigate('/qr-ready')} className="w-full py-3 rounded-xl bg-success text-white font-bold hover:bg-green-600 transition-colors shadow-lg shadow-success/20 flex items-center justify-center gap-2">
                            <span className="material-symbols-outlined">qr_code_2</span>
                            {t('qrReady')}
                        </button>
                        <button onClick={() => navigate('/')} className="mt-4 text-gray-400 hover:text-white text-sm font-medium">
                            {t('backToHome')}
                        </button>
                    </div>
                </div>
            );
        };

        const QRReady = () => {
            const { t } = useApp();
            const navigate = useNavigate();

            return (
                <div className="flex-1 flex items-center justify-center p-4 page-transition">
                    <div className="max-w-md w-full flex flex-col gap-6">
                        <div className="text-center">
                            <h1 className="text-3xl font-bold text-white mb-2">{t('qrReady')}</h1>
                            <p className="text-gray-400">{t('qrDesc')}</p>
                        </div>

                        <div className="bg-white rounded-2xl p-6 shadow-2xl flex flex-col items-center gap-4">
                            <div className="border-4 border-primary/20 rounded-xl p-2">
                                <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=NUBL-123456" alt="QR Code" className="w-48 h-48" />
                            </div>
                            <div className="text-center">
                                <p className="text-gray-500 text-xs uppercase tracking-wider mb-1">{t('qrAlt')}</p>
                                <p className="text-2xl font-mono font-bold text-gray-900 tracking-widest">4921 5502</p>
                            </div>
                        </div>

                        <div className="bg-blue-500/10 border border-blue-500/20 rounded-xl p-4 flex gap-3">
                            <span className="material-symbols-outlined text-blue-400">security</span>
                            <div>
                                <h4 className="font-bold text-blue-100">{t('securityNote')}</h4>
                                <p className="text-sm text-blue-200/70">{t('securityDesc')}</p>
                            </div>
                        </div>

                        <button onClick={() => navigate('/')} className="w-full py-3 rounded-xl border border-white/10 text-white font-bold hover:bg-white/5 transition-colors">
                            {t('backToHome')}
                        </button>
                    </div>
                </div>
            );
        };

        const RejectedStatus = () => {
            const { t } = useApp();
            const navigate = useNavigate();

            return (
                <div className="flex-1 flex items-center justify-center p-4 page-transition">
                    <div className="bg-surface-dark border border-border-dark rounded-2xl p-8 max-w-lg w-full">
                        <div className="flex items-center gap-4 mb-6 text-danger">
                            <span className="material-symbols-outlined text-4xl">error</span>
                            <div>
                                <h1 className="text-xl font-bold text-white">{t('rejectedTitle')}</h1>
                                <p className="text-danger/80 text-sm">{t('rejectedDesc')}</p>
                            </div>
                        </div>

                        <div className="bg-background-dark rounded-xl p-4 mb-6 border border-border-dark">
                            <div className="flex gap-3">
                                <span className="material-symbols-outlined text-gray-400">info</span>
                                <div>
                                    <p className="text-white font-medium">Reason for rejection</p>
                                    <p className="text-sm text-gray-400 mt-1">The requested quantity exceeds the monthly allowance for this category.</p>
                                </div>
                            </div>
                        </div>

                        <div className="flex gap-3">
                            <button onClick={() => navigate('/rejected-appeal')} className="flex-1 py-3 rounded-xl bg-danger text-white font-bold hover:bg-red-600 transition-colors shadow-lg shadow-danger/20">
                                {t('appeal')}
                            </button>
                            <button onClick={() => navigate('/')} className="flex-1 py-3 rounded-xl border border-border-dark text-white font-bold hover:bg-white/5 transition-colors">
                                {t('backToHome')}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const RejectedAppeal = () => {
            const { t } = useApp();
            const navigate = useNavigate();
            const [showModal, setShowModal] = useState(false);

            return (
                <div className="flex-1 flex items-center justify-center p-4 page-transition">
                    <div className="max-w-2xl w-full">
                        <div className="bg-surface-dark border border-border-dark rounded-2xl p-6 md:p-8">
                            <h2 className="text-2xl font-bold text-white mb-2">{t('appealTitle')}</h2>
                            <p className="text-gray-400 mb-6">Provide justification for your request to be reconsidered.</p>

                            <textarea className="w-full h-32 bg-background-dark border border-border-dark rounded-xl p-4 text-white focus:border-primary focus:ring-1 focus:ring-primary mb-4 resize-none" placeholder="Type your reason here..."></textarea>

                            <div className="border-2 border-dashed border-border-dark rounded-xl h-24 flex flex-col items-center justify-center mb-6 cursor-pointer hover:bg-white/5 transition-colors group">
                                <span className="material-symbols-outlined text-gray-400 group-hover:text-primary transition-colors">cloud_upload</span>
                                <span className="text-sm text-gray-500 mt-2">{t('upload')}</span>
                            </div>

                            <div className="flex gap-4">
                                <button onClick={() => navigate('/pending')} className="flex-1 py-3 rounded-xl bg-primary text-white font-bold hover:bg-primary-hover transition-colors">
                                    {t('send')}
                                </button>
                                <button onClick={() => navigate(-1)} className="flex-1 py-3 rounded-xl border border-border-dark text-white font-bold hover:bg-white/5 transition-colors">
                                    {t('cancel')}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const Login = () => {
            const { t } = useApp();
            const navigate = useNavigate();

            return (
                <div className="min-h-screen flex items-center justify-center p-4 bg-background-dark">
                    <div className="w-full max-w-md bg-surface-dark border border-border-dark rounded-2xl p-8 shadow-2xl">
                        <div className="flex justify-center mb-8">
                            <span className="material-symbols-outlined text-primary text-5xl">grid_view</span>
                        </div>
                        <h1 className="text-2xl font-bold text-white text-center mb-2">{t('login')}</h1>
                        <p className="text-center text-gray-400 mb-8">Welcome back to NUBL</p>

                        <form onSubmit={(e) => { e.preventDefault(); navigate('/otp'); }} className="flex flex-col gap-4">
                            <div>
                                <label className="text-sm text-gray-300 font-medium mb-1 block">Email or Phone</label>
                                <input type="text" className="w-full bg-background-dark border border-border-dark rounded-xl px-4 py-3 text-white focus:border-primary focus:ring-1 focus:ring-primary" />
                            </div>
                            <div>
                                <label className="text-sm text-gray-300 font-medium mb-1 block">Password</label>
                                <input type="password" className="w-full bg-background-dark border border-border-dark rounded-xl px-4 py-3 text-white focus:border-primary focus:ring-1 focus:ring-primary" />
                            </div>
                            <button className="w-full py-3 rounded-xl bg-primary text-white font-bold hover:bg-primary-hover transition-colors mt-2">
                                {t('login')}
                            </button>
                        </form>
                        <p className="text-center mt-6 text-sm text-gray-400">
                            Don't have an account? <Link to="/signup" className="text-primary hover:underline">{t('signup')}</Link>
                        </p>
                    </div>
                </div>
            );
        };

        const SignUp = () => {
            const { t } = useApp();
            const navigate = useNavigate();

            return (
                <div className="min-h-screen flex items-center justify-center p-4 bg-background-dark">
                    <div className="w-full max-w-md bg-surface-dark border border-border-dark rounded-2xl p-8 shadow-2xl">
                        <h1 className="text-2xl font-bold text-white text-center mb-8">{t('signup')}</h1>

                        <form onSubmit={(e) => { e.preventDefault(); navigate('/otp'); }} className="flex flex-col gap-4">
                            <div>
                                <label className="text-sm text-gray-300 font-medium mb-1 block">Full Name</label>
                                <input type="text" className="w-full bg-background-dark border border-border-dark rounded-xl px-4 py-3 text-white focus:border-primary focus:ring-1 focus:ring-primary" />
                            </div>
                            <div>
                                <label className="text-sm text-gray-300 font-medium mb-1 block">Phone Number</label>
                                <input type="tel" className="w-full bg-background-dark border border-border-dark rounded-xl px-4 py-3 text-white focus:border-primary focus:ring-1 focus:ring-primary" placeholder="05..." />
                            </div>
                            <div>
                                <label className="text-sm text-gray-300 font-medium mb-1 block">Password</label>
                                <input type="password" className="w-full bg-background-dark border border-border-dark rounded-xl px-4 py-3 text-white focus:border-primary focus:ring-1 focus:ring-primary" />
                            </div>
                            <button className="w-full py-3 rounded-xl bg-primary text-white font-bold hover:bg-primary-hover transition-colors mt-2">
                                {t('signup')}
                            </button>
                        </form>
                        <p className="text-center mt-6 text-sm text-gray-400">
                            Already have an account? <Link to="/login" className="text-primary hover:underline">{t('login')}</Link>
                        </p>
                    </div>
                </div>
            );
        };

        // --- Main App ---
        const App = () => {
            return (
                <AppProvider>
                    <MemoryRouter>
                        <Routes>
                            <Route path="/login" element={<Login />} />
                            <Route path="/signup" element={<SignUp />} />
                            <Route path="/otp" element={<OTPVerification />} />

                            <Route element={<AppLayout />}>
                                <Route path="/" element={<BeneficiaryHome />} />
                                <Route path="/request-builder" element={<RequestBuilder />} />
                                <Route path="/review-submit" element={<ReviewSubmit />} />
                                <Route path="/pending" element={<PendingReview />} />
                                <Route path="/approved" element={<Approved />} />
                                <Route path="/qr-ready" element={<QRReady />} />
                                <Route path="/rejected-status" element={<RejectedStatus />} />
                                <Route path="/rejected-appeal" element={<RejectedAppeal />} />
                            </Route>
                        </Routes>
                    </MemoryRouter>
                </AppProvider>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>